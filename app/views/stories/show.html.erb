<span class="story-container">
  <div class="vote-container">
    <%= image_tag "arrow-highlight-dark.svg", id: "vote-up", class: "vote-arrow-up", onclick: "clickVote(this)" %>
    <%= image_tag "arrow-dark.svg", id: "vote-down", class: "vote-arrow-down", onclick: "clickVote(this)" %>
  </div>

  <h1><%= @story.title %></h1>
</span>

<% if !@story.subtitle.blank? %>
  <h3><em><%= @story.subtitle %></em></h3>
<% end %>

<p>created by: <%= @story.creator.username %></p>

<div class="inline-buttons-container">
  <% if current_user == @story.creator %>
    <%= button_to "Edit", edit_story_path(@story), method: :get, class: "inline-buttons" %> 
    <%= button_to "Delete", "/stories/#{@story.id}", method: :delete, class: "inline-buttons", data: {confirm: "Do you want to delete this story?"} %>
  <% end %>
</div>

<% if logged_in? %>
  <div class="generic-centered">
    <%= check_box_tag :new_snippet_checkbox, "1", false, onchange:"toggleNewSnippetLinks(this)" %>
    <%= label_tag :new_snippet_checkbox, "New Snippet Links" %>
  </div>
<% end %>

<hr>

<div class="story-body">
  <%= link_to "□", new_story_snippet_path(@story, position: 0), class: "new-snippet-link" %>

  <% @story.ordered_snippets.each.with_index(1) do |snippet, i| %>
    <% if snippet.paragraph_begin && snippet.position != 0 %>
      <p>
    <% end %>

    <% if snippet.user == current_user %>
      <%= link_to "#{snippet.content}", edit_story_snippet_path(@story, snippet), class: "edit-snippet-link", style: "color: #{current_user.get_contribution_color(@story)}" %>
    <% else %>
      <span style="color: <%= snippet.user.get_contribution_color(@story) %>;"> <%= snippet.content %> </span> 
    <% end %>

    <% if snippet.paragraph_end && snippet.position != @story.snippets.count %>
        </p>
      <% end %>

      <%= link_to "□", new_story_snippet_path(@story, position: i), class: "new-snippet-link" %>

    <% end %>
</div>


<script charset="utf-8">
  <% if @story.dark_theme %>
    console.log(document.getElementById("vote-up").src);
    document.getElementById("vote-up").src = "/assets/arrow-dark.svg";
    document.getElementById("vote-down").src = "/assets/arrow-dark.svg";
    document.getElementById("main-content").className = "content-container-dark";
  <% else %>
    document.getElementById("vote-up").src = "/assets/arrow.svg";
    document.getElementById("vote-down").src = "/assets/arrow.svg";
    document.getElementById("main-content").className = "content-container-light";
  <% end %>

  document.body.style.backgroundColor = "#<%= @story.color %>";  

  function clickVote(object) {
    console.log(object);
  };

  jscolor.installByClassName("jscolor");
</script>

